{"createdAt":"2025-10-02T16:55:33.365Z","updatedAt":"2025-10-02T17:28:18.066Z","id":"HCNaLvzmJseZln3T","name":"SQL SandBox","active":false,"isArchived":true,"nodes":[{"parameters":{},"type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[0,0],"id":"ebfcc909-2326-42cc-8613-b83307390511","name":"When clicking ‘Execute workflow’"},{"parameters":{"operation":"executeQuery","query":"WITH table_info AS (\n    SELECT \n        t.table_schema,\n        t.table_name,\n        string_agg(\n            c.column_name || ' (' || c.data_type || \n            CASE \n                WHEN c.character_maximum_length IS NOT NULL \n                THEN '(' || c.character_maximum_length || ')'\n                WHEN c.numeric_precision IS NOT NULL \n                THEN '(' || c.numeric_precision || \n                    CASE WHEN c.numeric_scale > 0 THEN ',' || c.numeric_scale ELSE '' END || ')'\n                ELSE ''\n            END || \n            CASE WHEN c.is_nullable = 'NO' THEN ' NOT NULL' ELSE '' END || ')',\n            ', ' ORDER BY c.ordinal_position\n        ) as columns\n    FROM information_schema.tables t\n    JOIN information_schema.columns c ON t.table_name = c.table_name \n        AND t.table_schema = c.table_schema\n    WHERE t.table_schema NOT IN ('information_schema', 'pg_catalog')\n    AND t.table_name NOT LIKE 'directus_%'\n    AND t.table_type = 'BASE TABLE'\n    GROUP BY t.table_schema, t.table_name\n),\nconstraint_info AS (\n    SELECT \n        tc.table_schema,\n        tc.table_name,\n        string_agg(\n            tc.constraint_type || ': ' || kcu.column_name ||\n            CASE \n                WHEN tc.constraint_type = 'FOREIGN KEY' \n                THEN ' -> ' || ccu.table_name || '(' || ccu.column_name || ')'\n                ELSE ''\n            END,\n            ', '\n        ) as constraints\n    FROM information_schema.table_constraints tc\n    LEFT JOIN information_schema.key_column_usage kcu \n        ON tc.constraint_name = kcu.constraint_name\n        AND tc.table_schema = kcu.table_schema\n    LEFT JOIN information_schema.constraint_column_usage ccu \n        ON ccu.constraint_name = tc.constraint_name\n        AND ccu.table_schema = tc.table_schema\n    WHERE tc.table_schema NOT IN ('information_schema', 'pg_catalog')\n    AND tc.table_name NOT LIKE 'directus_%'\n    GROUP BY tc.table_schema, tc.table_name\n)\nSELECT \n    ti.table_schema as \"Схема\",\n    ti.table_name as \"Таблица\",\n    ti.columns as \"Колонки\",\n    COALESCE(ci.constraints, 'Нет ограничений') as \"Ограничения\"\nFROM table_info ti\nLEFT JOIN constraint_info ci ON ti.table_schema = ci.table_schema \n    AND ti.table_name = ci.table_name\nORDER BY ti.table_schema, ti.table_name;","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[208,0],"id":"da44ab1d-428e-4e3b-81d2-cfec90f71c03","name":"Execute a SQL query","credentials":{"postgres":{"id":"IRbGwCxyepb2OPlB","name":"Postgres"}}}],"connections":{"When clicking ‘Execute workflow’":{"main":[[{"node":"Execute a SQL query","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"84579281-e68d-4280-9eaf-5dc8ade255f9","triggerCount":0,"shared":[{"createdAt":"2025-10-02T16:55:33.365Z","updatedAt":"2025-10-02T16:55:33.365Z","role":"workflow:owner","workflowId":"HCNaLvzmJseZln3T","projectId":"vI2eXglKNLswvn2H"}],"tags":[]}